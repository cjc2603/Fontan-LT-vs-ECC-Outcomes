---
title: "Transplant-Free Survival Following Contemporary Fontan Procedures"
subtitle: "A Comparative Analysis of Lateral Tunnel vs Extracardiac Conduit Techniques"
author: "Carlos Carhuas"
date: "December 10, 2025"
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: left
    number-sections: true
    code-fold: true
    code-summary: "Show code"
    code-tools: true
    theme: cosmo
    fig-width: 10
    fig-height: 8
    df-print: kable
execute:
  warning: false
  message: false
  echo: true
---

## Abstract

**Background:** The Fontan operation is the definitive palliation for patients with functionally univentricular hearts. Contemporary techniques include the Lateral Tunnel (LT) and Extracardiac Conduit (ECC) approaches, but comparative long-term outcomes remain incompletely characterized.

**Methods:** This retrospective cohort study analyzed 469 pediatric patients from the International Fontan Registry who underwent contemporary total cavopulmonary connection (TCPC) procedures. The primary outcome was a composite of death, heart transplantation, or Fontan takedown. Secondary outcomes included arrhythmia, thromboembolic events, and lymphatic complications. Kaplan-Meier survival analysis and Cox proportional hazards regression were used for analysis.

**Results:** Among 469 patients (328 ECC, 141 LT), 16 experienced the primary composite outcome over 60 months of follow-up with no significant difference between techniques (log-rank p = 0.84). Lymphatic complications were significantly more frequent in the LT group (p = 0.036). Age at Fontan was the only independent predictor of adverse outcomes (HR: 1.23 per year, p = 0.008).

**Conclusions:** Both contemporary Fontan techniques demonstrate excellent short-to-mid-term outcomes with event-free survival exceeding 92% at 5 years. Age at Fontan completion, rather than surgical technique, is the primary driver of adverse outcomes.

---

## Introduction

The Fontan operation remains the definitive palliative strategy for individuals born with functionally univentricular hearts, dramatically extending life expectancy beyond initial guarded projections (d'Udekem et al., 2014). Historical registry data demonstrate the durability of even earlier Fontan technique, showing an estimated 25-year survival of 76% for patients who underwent the earliest Atriopulmonary (AP) connection (d'Udekem et al., 2014). Surgical evolution has since refined the procedure to the Total Cavopulmonary Connection (TCPC) via the Lateral Tunnel (LT) and the Extracardiac Conduit (ECC) techniques. These technical modifications have yielded superior long-term survival rates and reduced the burden of arrhythmia seen in the older AP cohort (Poh et al., 2021).

Despite these improvements, the Fontan circulation is fundamentally limited by its reliance on passive pulmonary blood flow driven by chronically elevated central venous pressure. This inherent constraint leads to time-dependent deterioration and the progressive accumulation of acquired morbidities, which now represent the primary drivers of late failure and mortality (Poh et al., 2021). Factors such as the onset of atrial arrhythmia, Protein-Losing Enteropathy (PLE) or Plastic Bronchitis (PB), and late systemic ventricular dysfunction are overwhelmingly potent predictors of cardiac transplantation or death, dramatically separating patients who remain free of these complications from those who develop them (Poh et al., 2021).

Furthermore, the mechanism of late mortality often involves structural or physiological defects that are amenable to intervention but frequently missed by routine clinical surveillance (Poh et al., 2020). Studies analyzing the modes of late death reveal that a significant proportion of patients are asymptomatic shortly before catastrophic decline, and virtually all contemporary patients who die from Fontan circulatory failure possess potentially correctable anatomical lesions, underscoring a critical gap in objective surveillance strategies (Poh et al., 2020).

Within the modern TCPC era, ongoing analysis seeks to define the optimal surgical approach. Long-term follow-up from multicenter registries are divided on the theoretical advantages of the ECC and LT technique. A 15-year comparison found that ECC patients demonstrated superior freedom from a composite morbidity outcome compared to LT patients, with this difference largely attributable to a substantially lower hazard for developing sustained atrial arrhythmias in the ECC cohort (Seese et al., 2025). This electrical stability is clinically meaningful, as atrial arrhythmia is a powerful time-dependent predictor of mortality and transplantation (Poh et al., 2021). However, independent of arrhythmia, other serious late morbidities, including plastic bronchitis and PLE, appear comparable between the two contemporary techniques (Seese et al., 2025). In contrast, another study revealed that while operative mortality was similar between both techniques, patients undergoing ECC experienced significantly higher rates of 30-day readmission, prolonged hospitalization, pleural effusion, chylothorax, and stroke compared to LT (Kisamori et al., 2025).

Given the complex interplay between initial surgical technique, long-term arrhythmic risk, and the subsequent development of lethal time-dependent morbidities, a granular understanding of long-term outcomes across the dominant modern surgical variants is essential for guiding clinical practice. Therefore, the present study seeks to compare the long-term transplant-free survival and incidence of late morbidities following the LT and ECC Fontan procedures using data sourced from the International Fontan Registry (IFR), with the goal of identifying technique-specific predictors of failure in the modern surgical era.

---

## Methods

### Study Design

This study is a retrospective cohort analysis using data from the International Fontan Registry (IFR) to evaluate long-term outcomes following the two contemporary total cavopulmonary connection procedures: the Lateral Tunnel and Extracardiac Conduit Fontan operations. The IFR is a multicenter observational registry that includes perioperative, echocardiographic, and longitudinal follow-up data for patients with single-ventricle congenital heart disease.

The analytic cohort consists of pediatric patients younger than 18 years who underwent LT or ECC Fontan completion and had available postoperative follow-up within the registry. Patients with earlier atriopulmonary (AP) Fontan connections, missing Fontan-type assignments, incomplete follow-up, or insufficient outcome documentation were excluded to ensure the analysis reflected contemporary TCPC practice.

### Outcome Definitions

All endpoints were evaluated as time-to-first event, with follow-up times measured in months:

- **Primary Outcome:** A composite of Fontan takedown, all-cause mortality, or heart transplantation
- **Secondary Outcomes:**
  - New-onset arrhythmia requiring clinical attention
  - Thromboembolic events (stroke or intracardiac thrombus)
  - Lymphatic complications (chylous/prolonged effusions, PLE, or Plastic Bronchitis)

### Statistical Analysis Overview

Baseline characteristics were summarized using standard descriptive statistics and compared between Fontan types using Wilcoxon rank-sum tests for continuous variables and chi-square or Fisher's exact tests for categorical variables.

Time-to-event outcomes were analyzed using Kaplan-Meier survival estimation with curves truncated at 60 months (5 years) where both surgical groups maintained adequate sample sizes. Differences between groups were assessed using log-rank tests.

Given the limited number of primary outcome events (n=16), we adopted a dual modeling approach for Cox regression: a primary model with adequate statistical power (EPV = 8.0) including only Fontan type and age, and an exploratory full model including additional covariates interpreted as hypothesis-generating.

### Environment Setup

We begin by loading the R packages required for this analysis. The `survival` package provides core survival analysis functions including Kaplan-Meier estimation and Cox proportional hazards regression. The `survminer` package enhances visualization with publication-ready survival curves. The `tableone` package creates formatted baseline characteristic tables suitable for manuscripts.

```{r}
#| label: setup
#| code-fold: false

# Load required packages
library(readxl)
library(dplyr)
library(tidyr)
library(survival)
library(survminer)
library(ggplot2)
library(tableone)
library(broom)
library(knitr)
library(kableExtra)

# Set global options
options(scipen = 999)

# Set seed for reproducibility
set.seed(2025)
```

### Data Import

The dataset contains 477 patients with 46 variables capturing demographics, surgical details, echocardiographic findings, and clinical outcomes including mortality, transplantation, and Fontan takedown events.

```{r}
#| label: data-import

# Import the International Fontan Registry dataset
IFR <- read_excel("IFR_outcomes.xlsx")

# Display data structure
cat("Dataset dimensions:", nrow(IFR), "rows x", ncol(IFR), "columns\n")
```

### Data Cleaning and Variable Preparation

Raw registry data requires substantial preparation before analysis. Several time variables were stored as character strings and required conversion to numeric format. We created categorical variables with clinically meaningful labels to enhance interpretability of results.

Key variable transformations included:

- **Fontan type:** Coded as Extracardiac (1) or Lateral Tunnel (2) — this is our primary exposure variable
- **Age at Fontan:** Converted from months to years for clinical interpretability
- **Ventricular function:** Simplified from echocardiographic grading to Normal/Mild vs. Moderate/Severe dysfunction
- **AV valve regurgitation:** Categorized by severity (None/Trivial, Mild, Moderate, Severe)
- **Age categories:** Created clinically relevant groups (<2, 2-3, 3-4, ≥4 years)

```{r}
#| label: data-cleaning

# Create working dataset
IFR_analysis <- IFR

# Convert character variables to numeric
numeric_vars <- c("fontan_age1", "time_recfu1", "time_fon_rev1", "time_echo1", 
                  "echo_grad1", "time_fontd1", "time_death1")

for (var in numeric_vars) {
  if (var %in% names(IFR_analysis)) {
    IFR_analysis[[var]] <- as.numeric(IFR_analysis[[var]])
  }
}

# Create categorical variables with meaningful labels
IFR_analysis <- IFR_analysis %>%
  mutate(
    # Gender
    gender_cat = factor(gender, 
                        levels = c(1, 2), 
                        labels = c("Male", "Female")),
    
    # Fontan Type (Primary Exposure)
    fontan_type = factor(EC_LT,
                         levels = c(1, 2),
                         labels = c("Extracardiac", "Lateral Tunnel")),
    
    # Heterotaxy status
    heterotaxy_cat = factor(case_when(
      heterotaxy == 0 ~ "None",
      heterotaxy == 2 ~ "Left",
      heterotaxy == 3 ~ "Right",
      TRUE ~ "Unknown"
    )),
    
    # Fenestration status
    fenestration_cat = factor(fenestration,
                              levels = c(0, 1),
                              labels = c("No", "Yes")),
    
    # Age in years (converted from months)
    age_years = fontan_age1 / 12,
    
    # Age categories for descriptive analysis
    age_cat = cut(age_years,
                  breaks = c(0, 2, 3, 4, Inf),
                  labels = c("<2 years", "2-3 years", "3-4 years", "≥4 years"),
                  right = FALSE),
    
    # Ventricular function (simplified from echo grading)
    vent_function = case_when(
      qa_slv_reg1 <= 2 ~ "Normal/Mild dysfunction",
      qa_slv_reg1 > 2 & qa_slv_reg1 <= 10 ~ "Moderate/Severe dysfunction",
      TRUE ~ NA_character_
    ),
    vent_function = factor(vent_function),
    
    # AV valve regurgitation (categorical)
    avv_regurg = case_when(
      qa_avv_reg1 <= 2 ~ "None/Trivial",
      qa_avv_reg1 > 2 & qa_avv_reg1 <= 4 ~ "Mild",
      qa_avv_reg1 > 4 & qa_avv_reg1 <= 6 ~ "Moderate",
      qa_avv_reg1 > 6 ~ "Severe",
      TRUE ~ NA_character_
    ),
    avv_regurg = factor(avv_regurg, 
                        levels = c("None/Trivial", "Mild", "Moderate", "Severe"))
  )
```

### Outcome Variable Construction

The primary composite outcome captures the most clinically significant adverse events following Fontan completion: death, heart transplantation, and Fontan takedown (surgical revision or reversal). For patients experiencing multiple sequential events (e.g., Fontan takedown followed by death), time to the **first** event was used for analysis.

Follow-up times exceeding 360 months (30 years) were excluded as biologically implausible data entry errors given the age of the TCPC era.

```{r}
#| label: outcome-variables

# Maximum follow-up threshold (exclude implausible values)
MAX_FOLLOWUP_MONTHS <- 360  # 30 years

# Clean follow-up time
IFR_analysis <- IFR_analysis %>%
  mutate(
    time_recfu1 = ifelse(time_recfu1 > MAX_FOLLOWUP_MONTHS, NA, time_recfu1)
  )

# Primary Composite Outcome (Death, Transplant, or Fontan Takedown)
IFR_analysis <- IFR_analysis %>%
  mutate(
    primary_event = case_when(
      mortality == 1 ~ 1,
      htx == 1 ~ 1,
      fon_td1 == 1 ~ 1,
      TRUE ~ 0
    ),
    
    # Time to primary event (use earliest event time, or censoring time if event-free)
    time_to_primary = case_when(
      mortality == 1 ~ time_death1,
      htx == 1 ~ time_fontd1,
      fon_td1 == 1 ~ time_fontd1,
      TRUE ~ time_recfu1
    ),
    
    # Secondary outcomes
    arrhythmia_event = arrhyth,
    time_to_arrhythmia = time_recfu1,
    
    thrombo_event = thrombo,
    time_to_thrombo = time_recfu1,
    
    lymph_event = lymph,
    time_to_lymph = time_recfu1
  )

# Display event counts before exclusions
cat("Primary events (before exclusions):", sum(IFR_analysis$primary_event, na.rm = TRUE), "\n")
```

### Cohort Selection and Exclusions

We applied the following exclusion criteria to ensure the analysis reflected contemporary TCPC practice with complete outcome ascertainment:

1. Missing Fontan type assignment (AP connections or unspecified)
2. Age ≥18 years at Fontan (non-pediatric patients)
3. Missing or zero follow-up time
4. Missing primary outcome status

```{r}
#| label: cohort-selection

# Document initial cohort size
initial_n <- nrow(IFR_analysis)

# Apply exclusion criteria
IFR_analysis <- IFR_analysis %>%
  filter(
    !is.na(fontan_type),
    age_years < 18,
    !is.na(time_to_primary) & time_to_primary > 0,
    !is.na(primary_event)
  )

# Document final cohort size
final_n <- nrow(IFR_analysis)

cat("Initial cohort:", initial_n, "patients\n")
cat("Final analytical cohort:", final_n, "patients\n")
cat("Excluded:", initial_n - final_n, "patients\n\n")

# Distribution by Fontan type
cat("Distribution by Fontan type:\n")
print(table(IFR_analysis$fontan_type))
```

---

## Results

### Baseline Characteristics

The final analytical cohort included 469 patients who underwent contemporary TCPC Fontan procedures: 328 (69.9%) received Extracardiac conduit and 141 (30.1%) underwent Lateral Tunnel procedures. 

Significant differences were observed between surgical groups. The ECC cohort was older at the time of Fontan completion compared to the LT group, with a higher proportion of LT patients undergoing Fontan between 2-3 years of age. Females were more prevalent in the LT group. Fenestration was nearly universal in the LT cohort (94.3%) compared to 80.5% in the ECC group. Systemic ventricular function and atrioventricular valve regurgitation were comparable between groups.

Follow-up duration differed significantly, with the ECC cohort having substantially longer mean follow-up compared to the LT group, reflecting the more contemporary adoption of the Extracardiac technique.

```{r}
#| label: table1
#| tbl-cap: "Table 1. Baseline Characteristics Stratified by Fontan Type"

# Define variables for Table 1
table1_vars <- c(
  "gender_cat",
  "age_years",
  "age_cat",
  "heterotaxy_cat",
  "fenestration_cat",
  "conduitsz",
  "vent_function",
  "avv_regurg",
  "time_to_primary"
)

cat_vars <- c(
  "gender_cat",
  "age_cat",
  "heterotaxy_cat",
  "fenestration_cat",
  "vent_function",
  "avv_regurg"
)

# Create Table 1
table1 <- CreateTableOne(
  vars = table1_vars,
  strata = "fontan_type",
  data = IFR_analysis,
  factorVars = cat_vars,
  test = TRUE,
  addOverall = TRUE
)

# Print formatted table
kableone(table1, caption = "Baseline Characteristics by Fontan Type")
```

### Event Summary

During the first 60 months of follow-up, 16 patients experienced the primary composite outcome: 13 in the ECC group (4.0%) and 3 in the LT group (2.1%). Among these 16 patients, there were 14 deaths, 4 heart transplantations, and 7 Fontan takedowns, with 6 patients experiencing multiple sequential events.

The table below summarizes event rates and follow-up duration by surgical technique.

```{r}
#| label: table2
#| tbl-cap: "Table 2. Event Summary by Fontan Type"

# Create event summary
event_summary <- IFR_analysis %>%
  group_by(fontan_type) %>%
  summarise(
    N = n(),
    `Primary Composite Events` = paste0(sum(primary_event), " (", round(100 * sum(primary_event) / n(), 1), "%)"),
    `Median Follow-up (IQR)` = paste0(
      round(median(time_to_primary, na.rm = TRUE), 1), " (",
      round(quantile(time_to_primary, 0.25, na.rm = TRUE), 1), "-",
      round(quantile(time_to_primary, 0.75, na.rm = TRUE), 1), ")"
    ),
    `Arrhythmia Events` = paste0(sum(arrhythmia_event), " (", round(100 * sum(arrhythmia_event) / n(), 1), "%)"),
    `Thromboembolic Events` = paste0(sum(thrombo_event), " (", round(100 * sum(thrombo_event) / n(), 1), "%)"),
    `Lymphatic Complications` = paste0(sum(lymph_event), " (", round(100 * sum(lymph_event) / n(), 1), "%)"),
    .groups = "drop"
  )

kable(event_summary, align = "lcccccc") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

---

### Kaplan-Meier Survival Analysis

Kaplan-Meier survival curves were constructed to visualize time-to-event outcomes for the primary composite outcome and each secondary outcome. Survival curves were truncated at 60 months (5 years) for all outcomes, as this represented the period where both surgical groups maintained adequate sample sizes for reliable comparison. At 60 months, the Extracardiac cohort had 50 patients at risk (15.2% of original sample), while the Lateral Tunnel cohort had 4 patients at risk (2.8% of original sample).

#### Primary Composite Outcome

There was no statistically significant difference in freedom from the composite outcome between surgical techniques (log-rank p = 0.84). At 60 months, event-free survival remained excellent in both cohorts, with the Lateral Tunnel group maintaining event-free survival above 97% and the Extracardiac group achieving approximately 93%.

```{r}
#| label: fig-km-primary
#| fig-cap: "Figure 1. Kaplan-Meier survival curves for freedom from death, heart transplant, or Fontan takedown by surgical technique. Curves are truncated at 60 months where both groups maintained adequate sample sizes. There was no statistically significant difference between groups (log-rank p = 0.84)."

# Create survival object
surv_primary <- Surv(time = IFR_analysis$time_to_primary, 
                     event = IFR_analysis$primary_event)

# Fit Kaplan-Meier curves
km_primary <- survfit(surv_primary ~ fontan_type, data = IFR_analysis)

# Log-rank test
logrank_primary <- survdiff(surv_primary ~ fontan_type, data = IFR_analysis)
p_value_primary <- 1 - pchisq(logrank_primary$chisq, df = 1)

# Create plot
km_plot_primary <- ggsurvplot(
  km_primary,
  data = IFR_analysis,
  pval = TRUE,
  conf.int = FALSE,
  risk.table = TRUE,
  risk.table.height = 0.25,
  ggtheme = theme_minimal(),
  palette = c("#E7B800", "#2E9FDF"),
  title = "Freedom from Death, Transplant, or Fontan Takedown",
  subtitle = "Truncated at 60 months (both groups with adequate follow-up)",
  xlab = "Time from Fontan (months)",
  ylab = "Event-Free Survival",
  legend.title = "Fontan Type",
  legend.labs = c("Extracardiac", "Lateral Tunnel"),
  break.time.by = 12,
  xlim = c(0, 60),
  ylim = c(0.92, 1.00),
  break.y.by = 0.02
)

print(km_plot_primary)
```

#### Secondary Outcome: Arrhythmia

New-onset arrhythmias requiring clinical intervention developed in 46 patients: 38 in the ECC group (11.6%) and 8 in the LT group (5.7%). At 60 months, arrhythmia-free survival was 84.0% for ECC and 87.4% for LT. The difference between groups was not statistically significant (log-rank p = 0.81).

Note that the Extracardiac cohort had longer median follow-up, which may influence event detection rates for time-dependent complications like arrhythmias.

```{r}
#| label: fig-km-arrhythmia
#| fig-cap: "Figure 2. Kaplan-Meier curves for freedom from new-onset arrhythmia by Fontan surgical technique. There was no statistically significant difference between groups (log-rank p = 0.81)."

surv_arrhythmia <- Surv(time = IFR_analysis$time_to_arrhythmia,
                        event = IFR_analysis$arrhythmia_event)

km_arrhythmia <- survfit(surv_arrhythmia ~ fontan_type, data = IFR_analysis)

km_plot_arrhythmia <- ggsurvplot(
  km_arrhythmia,
  data = IFR_analysis,
  pval = TRUE,
  conf.int = FALSE,
  risk.table = TRUE,
  risk.table.height = 0.25,
  ggtheme = theme_minimal(),
  palette = c("#E7B800", "#2E9FDF"),
  title = "Freedom from Arrhythmia by Fontan Type",
  subtitle = "Truncated at 60 months (both groups with adequate follow-up)",
  xlab = "Time from Fontan (months)",
  ylab = "Arrhythmia-Free Probability",
  legend.title = "Fontan Type",
  legend.labs = c("Extracardiac", "Lateral Tunnel"),
  break.time.by = 12,
  xlim = c(0, 60),
  ylim = c(0.85, 1.00),
  break.y.by = 0.05
)

print(km_plot_arrhythmia)
```

#### Secondary Outcome: Thromboembolic Events

Thromboembolic complications occurred in 40 patients: 35 in the ECC group (10.7%) and 5 in the LT group (3.5%). At 60 months, freedom from thromboembolic events was 82.7% for ECC and 94.5% for LT. While this difference did not reach statistical significance (log-rank p = 0.16), there was a notable trend toward higher thromboembolic event rates in the ECC cohort.

This trend may be attributable to synthetic conduit material in the Extracardiac approach being more thrombogenic than native atrial tissue used in Lateral Tunnel construction, or may reflect the longer follow-up duration in the ECC group providing more opportunity for event detection.

```{r}
#| label: fig-km-thrombo
#| fig-cap: "Figure 3. Kaplan-Meier curves for freedom from thromboembolic events by Fontan surgical technique. The difference showed a trend toward significance but was not statistically significant (log-rank p = 0.16)."

surv_thrombo <- Surv(time = IFR_analysis$time_to_thrombo,
                     event = IFR_analysis$thrombo_event)

km_thrombo <- survfit(surv_thrombo ~ fontan_type, data = IFR_analysis)

km_plot_thrombo <- ggsurvplot(
  km_thrombo,
  data = IFR_analysis,
  pval = TRUE,
  conf.int = FALSE,
  risk.table = TRUE,
  risk.table.height = 0.25,
  ggtheme = theme_minimal(),
  palette = c("#E7B800", "#2E9FDF"),
  title = "Freedom from Thromboembolic Events by Fontan Type",
  subtitle = "Truncated at 60 months (both groups with adequate follow-up)",
  xlab = "Time from Fontan (months)",
  ylab = "Event-Free Probability",
  legend.title = "Fontan Type",
  legend.labs = c("Extracardiac", "Lateral Tunnel"),
  break.time.by = 12,
  xlim = c(0, 60),
  ylim = c(0.80, 1.00),
  break.y.by = 0.05
)

print(km_plot_thrombo)
```

#### Secondary Outcome: Lymphatic Complications

Lymphatic complications occurred significantly more frequently in the Lateral Tunnel group. Twenty-one patients developed lymphatic complications: 13 in the ECC group (4.0%) and 8 in the LT group (5.7%). At 60 months, freedom from lymphatic complications was 94.5% for ECC and 84.1% for LT. This difference was statistically significant (log-rank p = 0.036), representing a 10.4% absolute difference favoring the ECC approach.

This finding may be attributable to more extensive intra-atrial dissection and suture lines in the Lateral Tunnel approach, potentially disrupting lymphatic drainage pathways. Alternatively, differences in flow dynamics and venous pressure between techniques may influence lymphatic congestion. Lymphatic complications were the only secondary outcome to demonstrate a statistically significant difference between surgical techniques.

```{r}
#| label: fig-km-lymphatic
#| fig-cap: "Figure 4. Kaplan-Meier curves for freedom from lymphatic complications by Fontan surgical technique. Lateral Tunnel patients had significantly higher rates of lymphatic complications including protein-losing enteropathy, plastic bronchitis, and chylous effusions (log-rank p = 0.036)."

surv_lymph <- Surv(time = IFR_analysis$time_to_lymph,
                   event = IFR_analysis$lymph_event)

km_lymph <- survfit(surv_lymph ~ fontan_type, data = IFR_analysis)

km_plot_lymph <- ggsurvplot(
  km_lymph,
  data = IFR_analysis,
  pval = TRUE,
  conf.int = FALSE,
  risk.table = TRUE,
  risk.table.height = 0.25,
  ggtheme = theme_minimal(),
  palette = c("#E7B800", "#2E9FDF"),
  title = "Freedom from Lymphatic Complications by Fontan Type",
  subtitle = "Truncated at 60 months (p = 0.036)",
  xlab = "Time from Fontan (months)",
  ylab = "Event-Free Probability",
  legend.title = "Fontan Type",
  legend.labs = c("Extracardiac", "Lateral Tunnel"),
  break.time.by = 12,
  xlim = c(0, 60),
  ylim = c(0.80, 1.00),
  break.y.by = 0.05
)

print(km_plot_lymph)
```

---

### Cox Proportional Hazards Regression

Cox proportional hazards regression was used to evaluate the association between Fontan technique and the primary composite outcome while adjusting for potential confounders. We first prepared binary versions of clinical variables for inclusion in regression models.

```{r}
#| label: cox-prep

# Create binary variables for Cox regression
IFR_analysis <- IFR_analysis %>%
  mutate(
    heterotaxy_binary = factor(
      ifelse(heterotaxy == 0, "No", "Yes"),
      levels = c("No", "Yes")
    ),
    vent_dysfunc_binary = factor(
      case_when(
        qa_slv_reg1 <= 2 ~ "Normal/Mild",
        qa_slv_reg1 > 2 ~ "Moderate/Severe",
        TRUE ~ NA_character_
      ),
      levels = c("Normal/Mild", "Moderate/Severe")
    ),
    avv_regurg_binary = factor(
      case_when(
        qa_avv_reg1 <= 4 ~ "None/Mild",
        qa_avv_reg1 > 4 ~ "Moderate/Severe",
        TRUE ~ NA_character_
      ),
      levels = c("None/Mild", "Moderate/Severe")
    )
  )
```

#### Univariable Analysis

We first examined the unadjusted association between each candidate predictor and the primary outcome. In univariable Cox regression, older age at Fontan completion was significantly associated with increased hazard of the primary outcome (HR per year: 1.225, 95% CI: 1.057-1.420, p = 0.007). Fontan type, gender, and heterotaxy status showed no significant associations.

Moderate-to-severe ventricular dysfunction (HR: 2.107) and AV valve regurgitation (HR: 2.167) showed trends toward increased risk but did not reach statistical significance, likely due to limited statistical power given the small number of events.

```{r}
#| label: table3-univariable
#| tbl-cap: "Table 3. Univariable Cox Regression Analysis for Primary Composite Outcome"

# Univariable models
cox_univ_fontan <- coxph(Surv(time_to_primary, primary_event) ~ fontan_type, data = IFR_analysis)
cox_univ_age <- coxph(Surv(time_to_primary, primary_event) ~ age_years, data = IFR_analysis)
cox_univ_gender <- coxph(Surv(time_to_primary, primary_event) ~ gender_cat, data = IFR_analysis)
cox_univ_het <- coxph(Surv(time_to_primary, primary_event) ~ heterotaxy_binary, data = IFR_analysis)
cox_univ_vent <- coxph(Surv(time_to_primary, primary_event) ~ vent_dysfunc_binary, data = IFR_analysis)
cox_univ_avv <- coxph(Surv(time_to_primary, primary_event) ~ avv_regurg_binary, data = IFR_analysis)

# Extract results
univariable_results <- data.frame(
  Variable = c("Fontan Type (LT vs EC)", 
               "Age at Fontan (per year)", 
               "Gender (Female vs Male)",
               "Heterotaxy (Yes vs No)",
               "Ventricular Dysfunction (Mod/Sev vs Normal/Mild)",
               "AV Regurgitation (Mod/Sev vs None/Mild)"),
  HR = round(c(
    summary(cox_univ_fontan)$conf.int[1],
    summary(cox_univ_age)$conf.int[1],
    summary(cox_univ_gender)$conf.int[1],
    summary(cox_univ_het)$conf.int[1],
    summary(cox_univ_vent)$conf.int[1],
    summary(cox_univ_avv)$conf.int[1]
  ), 3),
  CI_95 = c(
    paste0(round(summary(cox_univ_fontan)$conf.int[3], 3), "-", round(summary(cox_univ_fontan)$conf.int[4], 3)),
    paste0(round(summary(cox_univ_age)$conf.int[3], 3), "-", round(summary(cox_univ_age)$conf.int[4], 3)),
    paste0(round(summary(cox_univ_gender)$conf.int[3], 3), "-", round(summary(cox_univ_gender)$conf.int[4], 3)),
    paste0(round(summary(cox_univ_het)$conf.int[3], 3), "-", round(summary(cox_univ_het)$conf.int[4], 3)),
    paste0(round(summary(cox_univ_vent)$conf.int[3], 3), "-", round(summary(cox_univ_vent)$conf.int[4], 3)),
    paste0(round(summary(cox_univ_avv)$conf.int[3], 3), "-", round(summary(cox_univ_avv)$conf.int[4], 3))
  ),
  P_value = round(c(
    summary(cox_univ_fontan)$coefficients[5],
    summary(cox_univ_age)$coefficients[5],
    summary(cox_univ_gender)$coefficients[5],
    summary(cox_univ_het)$coefficients[5],
    summary(cox_univ_vent)$coefficients[5],
    summary(cox_univ_avv)$coefficients[5]
  ), 3)
)

kable(univariable_results, col.names = c("Variable", "HR", "95% CI", "P-value")) %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  row_spec(2, bold = TRUE, background = "#ffffcc")
```

#### Primary Multivariable Model

Given the limited number of primary outcome events (n=16), we adopted a dual modeling approach to balance statistical power with comprehensive covariate adjustment. The primary multivariable model included Fontan type and age at Fontan (2 predictors), yielding an events-per-variable (EPV) ratio of 8.0. An EPV ratio of at least 10 is generally recommended for reliable Cox regression estimates; our ratio of 8.0 in the primary model, while slightly below this threshold, provides reasonable statistical power for inference.

After adjusting for age at Fontan completion, the risk of death, transplant, or Fontan takedown did not differ significantly between LT and ECC groups (adjusted HR: 1.037, 95% CI: 0.282-3.809, p = 0.956). Age at Fontan was significantly associated with the primary outcome, with each one-year increase in age associated with a 22.6% increased hazard (adjusted HR: 1.226, 95% CI: 1.056-1.424, p = 0.008).

The proportional hazards assumption was tested using Schoenfeld residuals and was satisfied (global test p = 0.23).

```{r}
#| label: table4-multivariable
#| tbl-cap: "Table 4. Primary Multivariable Cox Regression Model (EPV = 8.0)"

# Calculate EPV
n_events <- sum(IFR_analysis$primary_event)
n_predictors <- 2
EPV <- n_events / n_predictors

cat("Sample size:", nrow(IFR_analysis), "patients\n")
cat("Events:", n_events, "\n")
cat("Predictors:", n_predictors, "\n")
cat("Events per variable (EPV):", EPV, "\n\n")

# Fit primary model
cox_primary <- coxph(
  Surv(time_to_primary, primary_event) ~ fontan_type + age_years,
  data = IFR_analysis
)

# Format results
primary_results <- tidy(cox_primary, exponentiate = TRUE, conf.int = TRUE) %>%
  mutate(
    Variable = case_when(
      term == "fontan_typeLateral Tunnel" ~ "Lateral Tunnel (vs Extracardiac)",
      term == "age_years" ~ "Age at Fontan (per year)",
      TRUE ~ term
    ),
    HR = round(estimate, 3),
    CI_95 = paste0(round(conf.low, 3), "-", round(conf.high, 3)),
    P_value = round(p.value, 3)
  ) %>%
  select(Variable, HR, CI_95, P_value)

kable(primary_results, col.names = c("Variable", "HR", "95% CI", "P-value")) %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  row_spec(2, bold = TRUE, background = "#ffffcc")

# Test proportional hazards assumption
ph_test <- cox.zph(cox_primary)
cat("\nProportional Hazards Assumption Test:\n")
cat("Global test p-value:", round(ph_test$table["GLOBAL", "p"], 3), "\n")
cat("Interpretation: PH assumption satisfied (p >= 0.05)\n")
```

#### Forest Plot

The forest plot below provides a visual representation of the adjusted hazard ratios from the primary multivariable Cox regression model. Age at Fontan (shown in red) was significantly associated with increased hazard, while Fontan type (shown in blue) showed no significant difference between techniques.

```{r}
#| label: fig-forest
#| fig-cap: "Figure 5. Forest plot of adjusted hazard ratios from primary multivariable Cox regression model. Age was significantly associated with increased hazard (HR 1.23, p = 0.008), while Fontan type showed no significant difference (HR 1.04, p = 0.96). Color indicates statistical significance (red: p < 0.05; blue: not significant)."
#| fig-height: 5

# Prepare data for forest plot
forest_data <- tidy(cox_primary, exponentiate = TRUE, conf.int = TRUE) %>%
  mutate(
    Variable = case_when(
      term == "fontan_typeLateral Tunnel" ~ "Lateral Tunnel (vs Extracardiac)",
      term == "age_years" ~ "Age at Fontan (per year)",
      TRUE ~ term
    ),
    significant = ifelse(p.value < 0.05, "Significant (p<0.05)", "Not Significant")
  )

# Create forest plot
ggplot(forest_data, aes(x = estimate, y = reorder(Variable, estimate), color = significant)) +
  geom_point(size = 4) +
  geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2, linewidth = 1) +
  geom_vline(xintercept = 1, linetype = "dashed", color = "black", linewidth = 0.8) +
  scale_x_log10(breaks = c(0.25, 0.5, 1, 2, 4)) +
  scale_color_manual(values = c("Significant (p<0.05)" = "#E63946", "Not Significant" = "#457B9D")) +
  labs(
    title = "Primary Multivariable Cox Regression Model",
    subtitle = "Adjusted Hazard Ratios with 95% Confidence Intervals",
    x = "Hazard Ratio (log scale)",
    y = "",
    color = ""
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    plot.subtitle = element_text(size = 11, color = "gray30"),
    legend.position = "bottom"
  )
```

#### Interaction Testing

Effect modification by age category was assessed through interaction testing to determine whether the effect of surgical technique differed between younger and older patients. No significant interaction was detected between Fontan type and age group (<3 vs ≥3 years), indicating the effect of surgical technique on the primary outcome was consistent across age strata.

```{r}
#| label: interaction-test

# Create age subgroups
IFR_analysis <- IFR_analysis %>%
  mutate(
    age_subgroup = factor(
      ifelse(age_years < 3, "Younger (<3 years)", "Older (≥3 years)"),
      levels = c("Younger (<3 years)", "Older (≥3 years)")
    )
  )

# Display sample sizes by subgroup
cat("Sample sizes by age subgroup and Fontan type:\n")
print(table(IFR_analysis$age_subgroup, IFR_analysis$fontan_type))

# Interaction test
cox_interaction <- coxph(
  Surv(time_to_primary, primary_event) ~ fontan_type * age_subgroup,
  data = IFR_analysis
)

# Extract interaction p-value
interaction_summary <- summary(cox_interaction)
interaction_term <- "fontan_typeLateral Tunnel:age_subgroupOlder (≥3 years)"

if(interaction_term %in% rownames(interaction_summary$coefficients)) {
  interaction_p <- interaction_summary$coefficients[interaction_term, 5]
  cat("\nInteraction (Fontan type x Age group) p-value:", round(interaction_p, 2), "\n")
  cat("\nInterpretation: No significant interaction detected (p = 0.87).\n")
  cat("The effect of surgical technique on outcomes is consistent across age strata.\n")
}
```

---

## Discussion

This retrospective cohort study of 469 patients from the International Fontan Registry compared long-term outcomes between contemporary Extracardiac conduit and Lateral Tunnel Fontan procedures. The principal findings were:

1. No significant difference in freedom from death, transplant, or Fontan takedown between surgical techniques over 60 months of follow-up
2. Lymphatic complications occurred significantly more frequently in the Lateral Tunnel cohort
3. Age at Fontan completion was the only independent predictor of adverse outcomes in multivariable analysis
4. Both surgical approaches demonstrated excellent short-to-mid-term results, with the Lateral Tunnel group achieving event-free survival above 97% and the Extracardiac group above 92% at 5 years

The lack of significant difference in the primary composite outcome between techniques aligns with several contemporary studies suggesting comparable survival between modern Fontan approaches. The finding that age at Fontan completion emerged as the most important predictor of adverse outcomes has significant clinical implications, supporting the timing of Fontan completion in the 2-4 year age range when anatomic and physiological conditions are favorable.

### Limitations

Several limitations warrant consideration:

1. Limited events (n=16) constrained statistical power for multivariable analysis
2. Differential follow-up duration between groups may have influenced event detection rates
3. Registry design precluded standardized surveillance protocols
4. Unmeasured confounders including surgical era effects and institutional practices could not be fully accounted for
5. Median follow-up of 30 months limits conclusions regarding long-term outcomes beyond 5 years

---

## Conclusion

In this multicenter cohort study of 469 patients undergoing contemporary Fontan palliation, Extracardiac conduit and Lateral Tunnel techniques demonstrated comparable freedom from death, transplant, and Fontan takedown over 60 months of follow-up. Lymphatic complications occurred significantly more frequently in Lateral Tunnel patients. Age at Fontan completion was the strongest predictor of adverse outcomes, emphasizing the importance of optimal timing for Fontan completion.

---

## Session Information

```{r}
#| label: session-info

sessionInfo()
```

---

## References

d'Udekem, Y., Iyengar, A. J., Galati, J. C., Forsdick, V., Weintraub, R. G., Wheaton, G. R., Bullock, A., Justo, R. N., Grigg, L. E., Sholler, G. F., Hope, S., Radford, D. J., Gentles, T. L., Celermajer, D. S., & Winlaw, D. S. (2014). Redefining Expectations of Long-Term Survival After the Fontan Procedure: Twenty-Five Years of Follow-Up From the Entire Population of Australia and New Zealand. *Circulation*, 130(11 Suppl 1), S32–S38.

Kisamori, E., Mehta, R., Venna, A., Kaminski, A., Park, I. H., Desai, M., Tongut, A., & d'Udekem, Y. (2025). Lateral Tunnel Fontan vs Extracardiac Conduit Early Outcomes: A Study of The Society of Thoracic Surgeons Congenital Heart Surgery Database. *Annals of Thoracic Surgery*.

Poh, C., Hornung, T., Celermajer, D. S., Radford, D. J., Justo, R. N., Andrews, D., du Plessis, K., Iyengar, A. J., Winlaw, D., & d'Udekem, Y. (2020). Modes of late mortality in patients with a Fontan circulation. *Heart*, 106(18), 1427–1431.

Poh, C. L., Cordina, R. L., Iyengar, A. J., Zannino, D., Grigg, L. E., Wheaton, G. R., Bullock, A., Ayer, J., Alphonso, N., Gentles, T. L., Celermajer, D. S., & d'Udekem, Y. (2021). Pre- and Post-operative determinants of transplantation-free survival after Fontan. The Australia and New Zealand experience. *IJC Heart & Vasculature*, 35, 100825.

Seese, L., Schiff, M., Morell, V. O., Tran, M., Arora, G., Olivieri, L. J., Follansbee, C., Christopher, A. B., Kreutzer, J., Fogel, M., Castro Medina, M., Diaz-Castrillon, C. E., Da Fonseca Da Silva, L., Da Silva, J. P., Rathod, R. H., Alsaied, T., & the FORCE Investigators. (2025). Multicenter Comparison of Long-Term Outcomes: Extracardiac Conduit Fontan vs Lateral Tunnel Fontan at 15-Year Follow-Up. *Annals of Thoracic Surgery*, 120(4), 1115–1124.
